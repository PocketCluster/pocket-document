<!DOCTYPE html>
<html lang="en">
<head>
    <title>The Mac Application Environment</title>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
    <meta charset="utf-8">
    <meta id="book-resource-type" name="book-resource-type" content="Guide">
    <meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/TP40010543">
    <meta id="document-version" name="document-version" content="5.2.0">
    <meta id="build" name="build" content="ded95564c405529dbbbe590063edd114" />
    <meta id="chapterId" name="chapterId" content="TP40010543-CH2">
    <meta id="date" name="date" content="2015-03-09">
    <meta id="description" name="description" content="Introduces the development process for Mac apps.">
    <meta id="book-title" name="book-title" content="Mac App Programming Guide">
    <meta id="book-root" name="book-root" content="../">
    <meta id="book-json" name="book-json" content="../book.json">
    <meta id="devcenter" name="devcenter" content="Mac Dev Center">
    <meta id="devcenter-url" name="devcenter-url" content="http://developer.apple.com/devcenter/mac">
    <meta id="reflib" name="reflib" content="Guides and Sample Code">
    <meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Technologies/Cocoa Layer/AppKit}, {Topic/General}">
    
    
    <meta id="copyright" name="copyright" content="Copyright 2017 Apple Inc. All Rights Reserved.">
    <meta id="xcode-display" name="xcode-display" content="render">
    <meta id="IndexTitle" name="IndexTitle" content="Mac App Programming Guide: The Mac Application Environment">
    <meta id="resources-uri" name="resources-uri" content="../../../../../Resources/1260">
    <link id="book-index-page" rel="Start" title="Mac App Programming Guide" type="text/html" href="../index.html">
    <link id="next-page" rel="Next" type="text/html" href="../CoreAppDesign/CoreAppDesign.html">
    <link id="previous-page" rel="Prev" type="text/html" href="../Introduction/Introduction.html">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1260/CSS/screen.css">
    
    <!-- xcode_css -->
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1260/CSS/feedback.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta id="platforms" name="platforms" content="">
</head>    
<body><a name="//apple_ref/doc/uid/TP40010543-CH2" title="The Mac Application Environment"></a>
    <div id="_omniture_top">
    <!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
    <script type="text/javascript">
    /* RSID: */
    var s_account="appleglobal,appleusdeveloper,dappdeveloperlib"
    </script>

    <script type="text/javascript" src="https://www.apple.com/metrics/scripts/s_code_h.js"></script>
    <script type="text/javascript">
    s.pageName=AC.Tracking.pageName();
    s.channel="www.us.developer"

    /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
    var s_code=s.t();if(s_code)document.write(s_code)</script>
    <!-- End SiteCatalyst code version: H.8. -->
    </div>

    <div id="adcHeader" class="hideOnPrint hideInXcode">
        <div id='ssi_Header' class="hideInXcode unified">
            <a id="ssi_LibraryTitle" href='../../../../../navigation/'>Guides and Sample Code</a>
            <a id="ssi_AppleDeveloperConnection" href='https://developer.apple.com/'>Developer</a>
            <div id='ssi_SearchButton' role="button" title="Search">Search</div>
        </div>
        <form id='ssi_SearchMenu' method='get' action='../../../../../search/' accept-charset='utf-8'>
            <label for='adcsearch'>Search Guides and Sample Code</label>
            
            
    
            <input type='search' id='ssi_SearchField' name='q' accesskey='s' results='5' />
        </form>
    </div>

    <header id="header">
        <div id="title" role="banner">
            <h1>Mac App Programming Guide</h1>
            <span id="file_links">
                <a id="PDF_link" role="button" tabindex='4' rel="alternate" title="Download PDF"><span id="pdf_icon"></span>PDF</a>
                <a id="Companion_link" role="button" tabindex='3' title="Download Companion File"><span id="companion_icon"></span>Companion File</a>
            </span>
        </div>
        <ul id="headerButtons" class="hideOnPrint" role="toolbar">
            <li id="toc_button" style="display:none">
                <button tabindex="5" id="table_of_contents" class="open" role="checkbox" aria-label="Show Table of Contents"><span class="disclosure"></span>Table of Contents</button>
            </li>
            <li id="jumpto_button" style="display:none" role="navigation"><select tabindex="6" id="jumpTo"><option value="top">Jump To&#133;</option></select></li>
            <li id="downloadSample_button" style="display:none">
                <a id="Sample_link"><button id="Sample_button">Download Sample Code</button></a>
            </li>
        </ul>
    </header>
    <nav id="tocContainer" tabindex="7">
        <ul id="toc" role="tree"></ul>
    </nav>

    <article id="contents" tabindex="0" role="main">
        <div id="pageNavigationLinks_top" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../CoreAppDesign/CoreAppDesign.html'>Next</a><a class='previousLink' rel='prev' href='../Introduction/Introduction.html'>Previous</a>
        </div>
        <a id="top" name="top"></a>
        <a id="INDEX" href="../index.html" style="display:none;"></a>
        
        <a name="//apple_ref/doc/uid/TP40010543-CH2-SW1" title="The Mac Application Environment"></a><h1 id="pageTitle">The Mac Application Environment</h1><p>OS X incorporates the latest technologies for creating powerful and fun-to-use apps. But the technologies by themselves are not enough to make every app great. What sets an app apart from its peers is how it helps the user achieve some tangible goal. After all, users are not going to care what technologies an app uses, as long as it helps them do what they need to do. An app that gets in the user’s way is going to be forgotten, but one that makes work (or play) easier and more fun is going to be remembered. </p><p>You use Cocoa to write apps for OS X. Cocoa gives you access to all of the features of OS X and allows you to integrate your app cleanly with the rest of the system. This chapter covers the key parts of OS X that help you create great apps. In particular, this chapter describes some of the important ease-of-use technologies introduced in OS X v10.7. For a more thorough list of technologies available in OS X, see <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067" data-renderer-version="1" target="_self">Mac Technology Overview</a></em>. </p><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW3" title="An Environment Designed for Ease of Use"></a><h2 class="jump">An Environment Designed for Ease of Use</h2><p>OS X strives to provide an environment that is transparent to users and as easy to use as possible. By making hard tasks simple and getting out of the way, the system makes it easier for the user to be creative and spend less time worrying about the steps needed to make the computer work. Of course, simplifying tasks means your app has to do more of the work, but OS X provides help in that respect too.</p><p>As you design your app, you should think about the tasks that users normally perform and find ways to make them easier. OS X  supports powerful ease-of-use features and design principles. For example:</p><ul class="ul"><li class="li"><p>Users should not have to save their work manually. The document model in Cocoa provides support for saving the user’s file-based documents without user interaction; see <span class="content_text"><a href="../CoreAppDesign/CoreAppDesign.html#//apple_ref/doc/uid/TP40010543-CH3-SW51" data-renderer-version="1">The Document Architecture Provides Many Capabilities for Free</a></span>. </p></li><li class="li"><p>Apps should restore the user’s work environment at login time. Cocoa provides support for archiving the current state of the app’s interface (including the state of unsaved documents) and restoring that state at launch time; see <span class="content_text"><a href="../CoreAppDesign/CoreAppDesign.html#//apple_ref/doc/uid/TP40010543-CH3-SW26" data-renderer-version="1">User Interface Preservation</a></span>.</p></li><li class="li"><p>Apps should support automatic termination so that the user never has to quit them. Automatic termination means that when the user closes an app’s windows, the app appears to quit but actually just moves to the background quietly. The advantage is that subsequent launches are nearly instant as the app simply moves back to the foreground; see <span class="content_text"><a href="../CoreAppDesign/CoreAppDesign.html#//apple_ref/doc/uid/TP40010543-CH3-SW22" data-renderer-version="1">Automatic and Sudden Termination of Apps Improve the User Experience</a></span></p></li><li class="li"><p>You should consider providing your users with an immersive, full-screen experience by implementing a full-screen version of your user interface. The full-screen experience eliminates outside distractions and allows the user to focus on their content; see <span class="content_text"><a href="../FullScreenApp/FullScreenApp.html#//apple_ref/doc/uid/TP40010543-CH6-SW1" data-renderer-version="1">Implementing the Full-Screen Experience</a></span>.</p></li><li class="li"><p>Support trackpad gestures for appropriate actions in your app. Gestures provide simple shortcuts for common tasks and can be used to supplement existing controls and menu commands. OS X provides automatic support for reporting gestures to your app through the normal event-handling mechanism; see <em><a href="../../../../Cocoa/Conceptual/EventOverview/Introduction/Introduction.html#//apple_ref/doc/uid/10000060i" data-renderer-version="1" target="_self">Cocoa Event Handling Guide</a></em>.</p></li><li class="li"><p>Consider minimizing or eliminating the user’s interactions with the raw file system. Rather than expose the entire file system to the user through the open and save panels, some apps, in the manner of iPhoto and iTunes, can provide a better user experience by presenting the user’s content in a simplified browser designed specifically for the app’s content. OS X uses a well-defined file system structure that allows you to place and find files easily and includes many technologies for accessing those files; see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW9" data-renderer-version="1">The File System</a></span>.</p></li><li class="li"><p>For apps that support custom document types, provide a Quick Look plug-in so that users can view your documents from outside of your app; see <em><a href="../../../../UserExperience/Conceptual/Quicklook_Programming_Guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005020" data-renderer-version="1" target="_self">Quick Look Programming Guide</a></em>.</p></li><li class="li"><p>Apps should support the fundamental features for the OS X user experience that make apps elegant and intuitive, such as direct manipulation and drag-and-drop. Users should remain in control, receive consistent feedback, and be able to explore because the app is forgiving with reversible actions; see <em><a href="../../../../UserExperience/Conceptual/OSXHIGuidelines/index.html#//apple_ref/doc/uid/20000957" data-renderer-version="2" target="_self">macOS Human Interface Guidelines</a></em>.</p></li></ul><p>All of the preceding features are supported by Cocoa and can be incorporated with relatively little effort. </p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW4" title="A Sophisticated Graphics Environment"></a><h2 class="jump">A Sophisticated Graphics Environment</h2><p>High-quality graphics and animation make your app look great and can convey a lot of information to the user.  Animations in particular are a great way to provide feedback about changes to your user interface. So as you design your app, keep the following ideas in mind:</p><ul class="ul"><li class="li"><p>Use animations to provide feedback and convey changes. Cocoa provides mechanisms for creating sophisticated animations quickly in both the AppKit and Core Animation frameworks. For information about creating view-based animations, see <em><a href="../../../../Cocoa/Conceptual/CocoaDrawingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40003290" data-renderer-version="1" target="_self">Cocoa Drawing Guide</a></em>. For information about using Core Animation to create your animations, see <em><a href="../../../../Cocoa/Conceptual/CoreAnimation_guide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40004514" data-renderer-version="1" target="_self">Core Animation Programming Guide</a></em>. </p></li><li class="li"><p>Include high-resolution versions of your art and graphics. OS X automatically loads high-resolution image resources when an app runs on a screen whose scaling factor is greater than 1.0. Including such image resources makes your app’s graphics look even sharper and crisper on those higher-resolution screens. </p></li></ul><p>For information about the graphics technologies available in OS X, see <span class="content_text"><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/MediaLayer/MediaLayer.html#//apple_ref/doc/uid/TP40001067-CH273" data-renderer-version="1" target="_self">Media Layer</a></span> in <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067" data-renderer-version="1" target="_self">Mac Technology Overview</a></em>. </p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW5" title="Low-Level Details of the Runtime Environment"></a><h2 class="jump">Low-Level Details of the Runtime Environment</h2><p>When you are ready to begin writing actual code, there are a lot of technologies available to make your life easier. OS X supports all of the basic features such as memory management, file management, networking, and concurrency that you need to write your code. In some cases, though, OS X also provides more sophisticated services (or specific coding conventions) that, when followed, can make writing your code even easier. </p><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW2" title="Based on UNIX"></a><h3 class="jump">Based on UNIX</h3><p>OS X is powered by a 64-bit Mach kernel, which manages processor resources, memory, and other low-level behaviors. On top of the kernel sits a modified version of the Berkeley Software Distribution (BSD) operating system, which provides interfaces that apps can use to interact with the lower-level system. This combination of Mach and BSD provides the following system-level support for your apps:</p><ul class="ul"><li class="li"><p><em class="newTerm">Preemptive multitasking</em>—All processes share the CPU efficiently. The kernel schedules processes in a way that ensures they all receive the time they need to run. Even background apps continue to receive CPU time to execute ongoing tasks.</p></li><li class="li"><p><em class="newTerm">Protected memory</em>—Each process runs in its own protected memory space, which prevents processes from accidentally interfering with each other. (Apps can share part of their memory space to implement fast interprocess communication but take responsibility for synchronizing and locking that memory appropriately.) </p></li><li class="li"><p><em class="newTerm">Virtual memory</em>—64-bit apps have a virtual address space of approximately 18 exabytes (18 billion billion bytes). (If you create a 32-bit app, the amount of virtual memory is only 4 GB.) When an app’s memory usage exceeds the amount of free physical memory, the system transparently writes pages to disk to make more room. Written out pages remain on disk until they are needed in memory again or the app exits.</p></li><li class="li"><p><em class="newTerm">Networking</em> and <em class="newTerm">Bonjour</em>—OS X provides support for the standard networking protocols and services in use today. BSD sockets provide the low-level communication mechanism for apps, but higher-level interfaces also exist. Bonjour simplifies the user networking experience by providing a dynamic way to advertise and connect to network services over TCP/IP. </p></li></ul><p>For detailed information about the underlying environment of OS X, see <span class="content_text"><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/SystemTechnology/SystemTechnology.html#//apple_ref/doc/uid/TP40001067-CH207" data-renderer-version="1" target="_self">Kernel and Device Drivers Layer</a></span> in <em><a href="../../../../MacOSX/Conceptual/OSX_Technology_Overview/About/About.html#//apple_ref/doc/uid/TP40001067" data-renderer-version="1" target="_self">Mac Technology Overview</a></em>. </p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW12" title="Concurrency and Threading"></a><h3 class="jump">Concurrency and Threading</h3><p>Each process starts off with a single thread of execution and can create more threads as needed. Although you can create threads directly using POSIX and other higher-level interfaces, for most types of work it is better to create them indirectly using <span class="pediaLink" data-header="Block object" data-contents="Block objects are a C-level syntactic and runtime feature that allow you to compose function expressions that can be passed as arguments, optionally stored, and used by multiple threads. "><a href="../../DevPedia-CocoaCore/Block.html#//apple_ref/doc/uid/TP40008195-CH3" data-renderer-version="1" target="_self">block objects</a></span> with <em class="newTerm">Grand Central Dispatch (GCD)</em> or <em class="newTerm">operation objects</em>, a Cocoa concurrency technology implemented by the <code>NSOperation</code> class.</p><p>GCD and operation objects are an alternative to raw threads that simplify or eliminate many of the problems normally associated with threaded programming, such as synchronization and locking. Specifically, they define an asynchronous programming model in which you specify only the work to be performed and the order in which you want it performed. The system then handles the tedious work required to schedule the necessary threads and execute your tasks as efficiently as possible on the current hardware. You should not use GCD or operations for work requiring time-sensitive data processing (such as audio or video playback), but you can use them for most other types of tasks.</p><p>For more information on using GCD and operation objects to implement concurrency in your apps, see <em><a href="../../ConcurrencyProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40008091" data-renderer-version="1" target="_self">Concurrency Programming Guide</a></em>. </p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW9" title="The File System"></a><h3 class="jump">The File System</h3><p>The file system in OS X is structured to provide a better experience for users. Rather than exposing the entire file system to the user, the Finder hides any files and directories that an average user should not need to use, such as the contents of low-level UNIX directories. This is done to provide a simpler interface for the end user (and only in places like the Finder and the open and save panels). Apps can still access any files and directories for which they have valid permissions, regardless of whether they are hidden by the Finder. </p><p>When creating apps, you should understand and follow the conventions associated with the OS X file system. Knowing where to put files and how to get information out of the file system ensures a better user experience.  </p><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW10" title="A Few Important App Directories"></a><h4 class="jump">A Few Important App Directories</h4><p>The OS X file system is organized in a way that groups related files and data together in specific places. Every file in the file system has its place and apps need to know where to put the files they create. This is especially important if you are distributing your app through the App Store, which expects you to put your app’s data files in specific directories. </p><p><span class="content_text">Table 1-1</span> lists the directories with which apps commonly interact. Some of these directories are inside the home directory, which is either the user’s home directory or, if the app adopts App Sandbox, the app’s container directory as described in <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW7" data-renderer-version="1">App Sandbox and XPC</a></span>. Because the actual paths can differ based on these conditions, use the <code><a href="https://developer.apple.com/reference/foundation/nsfilemanager/1407726-urlsfordirectory" target="_self" class="urlLink">URLsForDirectory:inDomains:</a></code> method of the <code><a href="https://developer.apple.com/reference/foundation/nsfilemanager" target="_self" class="urlLink">NSFileManager</a></code> class to retrieve the actual directory path. You can then add any custom directory and filename information to the returned URL object to complete the path.</p><a name="//apple_ref/doc/uid/TP40010543-CH2-SW13" title="Table 1-1Key directories for Mac apps"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong class="caption_number">Table 1-1</strong>&nbsp;&nbsp;Key directories for Mac apps</caption><tr><th scope="col" class="TableHeading_TableRow_TableCell"><p>Directory</p></th><th scope="col" class="TableHeading_TableRow_TableCell"><p>Description</p></th></tr><tr><td  scope="row"><p>Applications directory</p></td><td ><p>This is the installation directory for your app <span class="pediaLink" data-header="Bundle" data-contents="A bundle is a directory in the file system that groups executable code and related resources such as images and sounds together in one place. "><a href="../../DevPedia-CocoaCore/Bundle.html#//apple_ref/doc/uid/TP40008195-CH4" data-renderer-version="1" target="_self">bundle</a></span>. The path for the global Applications directory is <code>/Applications</code> but each user directory may have a local applications directory containing user-specific apps. Regardless, you should not need to use this path directly. To access resources inside your application bundle, use an <code><a href="https://developer.apple.com/reference/foundation/bundle" target="_self" class="urlLink">NSBundle</a></code> object instead.</p><p>For more information about the structure of your application bundle and how you locate resources, see <span class="content_text"><a href="../BuildTimeConfiguration/BuildTimeConfiguration.html#//apple_ref/doc/uid/TP40010543-CH8-SW2" data-renderer-version="1">The OS X Application Bundle</a></span>. </p></td></tr><tr><td  scope="row"><p>Home directory</p></td><td ><p>The configuration of your app determines the location of the home directory seen by your app:</p><ul class="threeHead"><li class="li"><p>For apps running in a sandbox in OS X v10.7 and later, the home directory is the app’s container directory. For more information about the container directory, see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW17" data-renderer-version="1">The Keychain</a></span>. </p></li><li class="li"><p>For apps running outside of a sandbox (including those running in versions of OS X before 10.7), the home directory is the user-specific subdirectory of <code>/Users</code> that contains the user’s files. </p></li></ul><p>To retrieve the path to the home directory, use the <code><a href="https://developer.apple.com/reference/foundation/1413045-nshomedirectory" target="_self" class="urlLink">NSHomeDirectory</a></code> function. </p></td></tr><tr><td  scope="row"><p>Library directory</p></td><td ><p>The Library directory is the top-level directory for storing private app-related data and preferences. There are several Library directories scattered throughout the system but you should always use the one located inside the current home directory.</p><p>Do not store files directly at the top-level of the Library directory. Instead, store them in one of the specific subdirectories described in this table.</p><p>In OS X v10.7 and later, the Finder hides the Library directory in the user’s home folder by default. Therefore, you should never store files in this directory that you want the user to access. </p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/nssystemdirectories/1613022-foundation_constants/nssearchpathdirectory/nslibrarydirectory" target="_self" class="urlLink">NSLibraryDirectory</a></code> search path key with the <code>NSUserDomainMask</code> domain. </p></td></tr><tr><td  scope="row"><p>Application Support directory </p></td><td ><p>The Application Support directory is where your app stores any type of file that supports the app but is not required for the app to run, such as document templates or configuration files. The files should be app-specific but should never store user data. This directory is located inside the Library directory.</p><p>Never store files at the top level of this directory: Always put them in a subdirectory named for your app or company.</p><p>If the resources apply to all users on the system, such as document templates, place them in <code>/Library/Application Support</code>. To get the path to this directory use the <code><a href="https://developer.apple.com/reference/foundation/nssearchpathdirectory/nsapplicationsupportdirectory" target="_self" class="urlLink">NSApplicationSupportDirectory</a></code> search path key with the <code>NSLocalDomainMask</code> domain. If the resources are user-specific, such as workspace configuration files, place them in the current user’s <code>~/Library/Application Support</code> directory. To get the path to this directory use the <code><a href="https://developer.apple.com/reference/foundation/nssearchpathdirectory/nsapplicationsupportdirectory" target="_self" class="urlLink">NSApplicationSupportDirectory</a></code> search path key with the <code><a href="https://developer.apple.com/reference/nssystemdirectories/1613022-foundation_constants/nssearchpathdomainmask/nsuserdomainmask" target="_self" class="urlLink">NSUserDomainMask</a></code> domain.</p></td></tr><tr><td  scope="row"><p>Caches directory</p></td><td ><p>The Caches directory is where you store cache files and other temporary data that your app can re-create as needed. This directory is located inside the Library directory.</p><p>Never store files at the top level of this directory: Always put them in a subdirectory named for your app or company. Your app is responsible for cleaning out cache data files when they are no longer needed. The system does not delete files from this directory.</p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/foundation/filemanager.searchpathdirectory/1413518-cachesdirectory" target="_self" class="urlLink">NSCachesDirectory</a></code> search path key with the <code>NSUserDomainMask</code> domain. </p></td></tr><tr><td  scope="row"><p>Movies directory</p></td><td ><p>The Movies directory contains the user’s video files. </p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/nssystemdirectories/1613022-foundation_constants/nssearchpathdirectory/nsmoviesdirectory" target="_self" class="urlLink">NSMoviesDirectory</a></code> search path key with the <code>NSUserDomainMask</code> domain. </p></td></tr><tr><td  scope="row"><p>Music directory</p></td><td ><p>The Music directory contains the user’s music and audio files. </p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/_usr_include_nssystemdirectories.h/1613022-foundation_constants/nssearchpathdirectory/nsmusicdirectory" target="_self" class="urlLink">NSMusicDirectory</a></code> search path key with the <code>NSUserDomainMask</code> domain. </p></td></tr><tr><td  scope="row"><p>Pictures directory</p></td><td ><p>The Pictures directory contains the user’s images and photos. </p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/_usr_include_nssystemdirectories.h/1613022-foundation_constants/nssearchpathdirectory/nspicturesdirectory" target="_self" class="urlLink">NSPicturesDirectory</a></code> search path key with the <code>NSUserDomainMask</code> domain. </p></td></tr><tr><td  scope="row"><p>Temporary directory</p></td><td ><p>The Temporary directory is where you store files that do not need to persist between launches of your app. You normally use this directory for scratch files or other types of short-lived data files that are not related to your app’s persistent data. This directory is typically hidden from the user. </p><p>Your app should remove files from this directory as soon as it is done with them. The system may also purge lingering files from this directory at system startup. </p><p>To get the path to this directory use the <code><a href="https://developer.apple.com/reference/foundation/1409211-nstemporarydirectory" target="_self" class="urlLink">NSTemporaryDirectory</a></code> function.  </p></td></tr></table></div><p><span class="content_text">Listing 1-1</span> shows an example of how to retrieve the base path to the <code>Application Support</code> directory and then append a custom app directory to it.</p><a name="//apple_ref/doc/uid/TP40010543-CH2-SW14" title="Listing 1-1Getting the path to the Application Support directory"></a><p class="codesample clear"><strong class="caption_number">Listing 1-1</strong>&nbsp;&nbsp;Getting the path to the <code>Application Support</code> directory</p><div class="codesample clear"><table><tr><td scope="row"><pre>NSFileManager* fileManager = [NSFileManager defaultManager];<span></span></pre></td></tr><tr><td scope="row"><pre>NSURL* appSupportDir = nil;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>NSArray *urls = [fileManager URLsForDirectory:NSApplicationSupportDirectory inDomains:NSUserDomainMask];<span></span></pre></td></tr><tr><td scope="row"><pre>if ([paths count] &gt; 0) {<span></span></pre></td></tr><tr><td scope="row"><pre>   appSupportDir = [[urls objectAtIndex:0] URLByAppendingPathComponent:@"com.example.MyApp"];<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For more information about how to access files in well known system directories, see <em><a href="../../../../FileManagement/Conceptual/FileSystemProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672" data-renderer-version="1" target="_self">File System Programming Guide</a></em>. </p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW16" title="Coordinating File Access with Other Processes"></a><h4 class="jump">Coordinating File Access with Other Processes</h4><p>In OS X, other processes may have access to the same files that your app does. Therefore, when working with files, you should use the file coordination interfaces introduced in OS X v10.7 to be notified when other processes (including the Finder) attempt to read or modify files your app is currently using. For example, coordinating file access is critical when your app adopts iCloud storage.</p><p>The file coordination APIs allow you to assert ownership over files and directories that your app cares about. Any time another process attempts to touch one of those items, your app is given a chance to respond. For example, when an app attempts to read the contents of a document your app is editing, you can write unsaved changes to disk before the other process is allowed to do its reading.</p><p>Using iCloud document storage, for example, you must incorporate file coordination because multiple apps can access your document files in iCloud. The simplest way to incorporate file coordination into your app is to use the <code>NSDocument</code> class, which handles all of the file-related management for you. See <em><a href="../../../../DataManagement/Conceptual/DocBasedAppProgrammingGuideForOSX/Introduction/Introduction.html#//apple_ref/doc/uid/TP40011179" data-renderer-version="1" target="_self">Document-Based App Programming Guide for Mac</a></em>.</p><p>On the other hand, if you're writing a library-style (or “shoebox”) app, you must use the file coordination interfaces directly, as described in <em><a href="../../../../FileManagement/Conceptual/FileSystemProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672" data-renderer-version="1" target="_self">File System Programming Guide</a></em>.</p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW11" title="Interacting with the File System"></a><h4 class="jump">Interacting with the File System</h4><p>Disks in Macintosh computers are formatted using the HFS+ file system by default. However, Macintosh computers can interact with disks that use other formats so you should never code specifically to any one file system. <span class="content_text">Table 1-2</span> lists some of the basic file system attributes you may need to consider in your app and how you should handle them. </p><a name="//apple_ref/doc/uid/TP40010543-CH2-SW15" title="Table 1-2Attributes for the OS X file system"></a><div class="tableholder"><table class="graybox" border = "0" cellspacing="0" cellpadding="5"><caption class="tablecaption"><strong class="caption_number">Table 1-2</strong>&nbsp;&nbsp;Attributes for the OS X file system</caption><tr><th scope="col" class="TableHeading_TableRow_TableCell"><p>Attribute</p></th><th scope="col" class="TableHeading_TableRow_TableCell"><p>Description</p></th></tr><tr><td  scope="row"><p>Case sensitivity</p></td><td ><p>The HFS+ file system is case-insensitive but also case-preserving. Therefore, when specifying filenames and directories in your code, it is best to assume case-sensitivity.</p></td></tr><tr><td  scope="row"><p>Path construction</p></td><td ><p>Construct paths using the methods of the <code><a href="https://developer.apple.com/reference/foundation/nsurl" target="_self" class="urlLink">NSURL</a></code> and <code><a href="https://developer.apple.com/reference/foundation/nsstring" target="_self" class="urlLink">NSString</a></code> classes. The <code>NSURL</code> class is preferred for path construction because of its ability to specify not only paths in the local file system but paths to network resources.  </p></td></tr><tr><td  scope="row"><p>File attributes</p></td><td ><p>Many file-related attributes can be retrieved using the <code><a href="https://developer.apple.com/reference/foundation/nsurl/1408874-getresourcevalue" target="_self" class="urlLink">getResourceValue:forKey:error:</a></code> method of the <code>NSURL</code> class. You can also use an <code>NSFileManager</code> object to retrieve many file-related attributes. </p></td></tr><tr><td  scope="row"><p>File permissions</p></td><td ><p>File permissions are managed using access control lists (ACLs) and BSD permissions. The system uses ACLs whenever possible to specify precise permissions for files and directories, but it falls back to using BSD permissions when no ACLs are specified. </p><p>By default, any files your app creates are owned by the current user and given appropriate permissions. Thus, your app should always be able to read and write files it creates explicitly. In addition, the app’s sandbox may allow it to access other files in specific situations. For more information about the sandbox, see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW7" data-renderer-version="1">App Sandbox and XPC</a></span>. </p></td></tr><tr><td  scope="row"><p>Tracking file changes</p></td><td ><p>Apps that cannot use the File Coordination interfaces (see <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW16" data-renderer-version="1">Coordinating File Access with Other Processes</a></span>) to track changes to files and directories can use the FSEvents API instead. This API provides a lower-level interface for tracking file system interactions and is available in OS X v10.5 and later. </p><p>For information on how to use the FSEvents API, see <em><a href="../../../../Darwin/Conceptual/FSEvents_ProgGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005289" data-renderer-version="1" target="_self">File System Events Programming Guide</a></em>.</p></td></tr></table></div></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-DontLinkElementID_1" title="File-System Usage Requirements for the Mac App Store"></a><h4 class="jump">File-System Usage Requirements for the Mac App Store</h4><p>To promote a more consistent user experience, applications submitted to the Mac App Store must follow certain rules about where they write files. Users can be confused when applications cause unexpected side effects on the file system (for example, storing databases in the user’s Documents folder, storing files in the user’s Library folder that are not recognizably associated with your application, storing user data in the user’s Library folder, and so on).</p><p>Your application must adhere to the following requirements:</p><ul class="ul"><li class="li"><p>You may use Apple frameworks such as User Defaults, Calendar Store, and Address Book that implicitly write to files in specific locations, including locations your application is not allowed to access directly.</p></li><li class="li"><p>Your application may write to temporary paths that you acquire using the appropriate Apple programming interfaces, such as the <code><a href="https://developer.apple.com/reference/foundation/1409211-nstemporarydirectory" target="_self" class="urlLink">NSTemporaryDirectory</a></code> function.</p></li><li class="li"><p>Your application may write to the following directories:</p><ul class="nested"><li class="nested li"><p><code>~/Library/Application Support/&lt;app-identifier&gt;</code></p></li><li class="nested li"><p><code>~/Library/&lt;app-identifier&gt;</code></p></li><li class="nested li"><p><code>~/Library/Caches/&lt;app-identifier&gt;</code></p></li></ul><p>where <em>&lt;app-identifier&gt;</em> is your application's bundle identifier, its name, or your company’s name. This must exactly match what is in iTunes Connect for the application.</p><p>Always use Apple programming interfaces such as the <code><a href="https://developer.apple.com/reference/foundation/nsfilemanager/1407726-urlsfordirectory" target="_self" class="urlLink">URLsForDirectory:inDomains:</a></code> function to locate these paths rather than hardcoding them. For more information, see <em><a href="../../../../FileManagement/Conceptual/FileSystemProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672" data-renderer-version="1" target="_self">File System Programming Guide</a></em>.</p></li><li class="li"><p>If your application manages libraries of pictures, music, or movies, the application may also write to the following directories:</p><ul class="nested"><li class="nested li"><p><code>~/Pictures/&lt;app-identifier&gt;</code></p></li><li class="nested li"><p><code>~/Music/&lt;app-identifier&gt;</code></p></li><li class="nested li"><p><code>~/Movies/&lt;app-identifier&gt;</code></p></li></ul></li><li class="li"><p>If the user explicitly chooses to save data in an alternate location (using a Save As dialog), your application may write to the chosen location.</p></li></ul></section></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW6" title="Security"></a><h3 class="jump">Security</h3><p>The security technologies in OS X help you safeguard sensitive data created or managed by your app, and help minimize damage caused by successful attacks from hostile code. These technologies impact how your app interacts with system resources and the file system.</p><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW7" title="App Sandbox and XPC"></a><h4 class="jump">App Sandbox and XPC</h4><p>You secure your app against attack from malware by following the practices recommended in <em><a href="../../../../Security/Conceptual/SecureCodingGuide/Introduction.html#//apple_ref/doc/uid/TP40002415" data-renderer-version="1" target="_self">Secure Coding Guide</a></em>. But an attacker needs only to find a single hole in your defenses, or in any of the frameworks and libraries that you link against, to gain control of your app along with all of its privileges.</p><p><em class="newTerm">App Sandbox</em> provides a last line of defense against stolen, corrupted, or deleted user data if malicious code exploits your app. App Sandbox also minimizes the damage from coding errors. Its strategy is twofold:</p><ol class="ol"><li class="li"><p>App Sandbox enables you to describe how your app interacts with the system. The system then grants your app the access it needs to get its job done, and no more. For your app to provide the highest level of damage containment, the best practice is to adopt the tightest sandbox possible.</p></li><li class="li"><p>App Sandbox allows the user to transparently grant your app additional access by way of Open and Save dialogs, drag and drop, and other familiar user interactions.</p></li></ol><p>You describe your app’s interaction with the system by way of setting entitlements in Xcode. An <em class="newTerm">entitlement</em> is a key-value pair, defined in a <span class="pediaLink" data-header="Property list" data-contents="A property list is a representation of a hierarchy of objects that can be stored in the file system and reconstituted later. "><a href="../../DevPedia-CocoaCore/PropertyList.html#//apple_ref/doc/uid/TP40008195-CH44" data-renderer-version="1" target="_self">property list file</a></span>, that confers a specific capability or security permission to a target. For example, there are entitlement keys to indicate that your app needs access to the camera, the network, and user data such as the Address Book. For details on all the entitlements available in OS X, see <em><a href="../../../../Miscellaneous/Reference/EntitlementKeyReference/Chapters/AboutEntitlements.html#//apple_ref/doc/uid/TP40011195" data-renderer-version="1" target="_self">Entitlement Key Reference</a></em>.</p><p>When you adopt App Sandbox, the system provides a special directory for use by your app—and only by your app—called a <em class="newTerm">container</em>. Your app has unfettered read/write access to the container. All OS X path-finding APIs, above the POSIX layer, are relative to the container instead of to the user’s home directory. Other sandboxed apps have no access to your app’s container, as described further in <span class="content_text"><a href="#//apple_ref/doc/uid/TP40010543-CH2-SW8" data-renderer-version="1">Code Signing</a></span>.</p><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40010543-CH2-SW18" title="iOS Note"></a><p><strong>iOS Note:</strong>&nbsp;Because it is not for user documents, an OS X container differs from an iOS container which, in iOS, is the one and only location for user documents. As the sole local location for user documents, an iOS container is usually known simply as an app’s Documents directory.</p><p>In addition, an iOS container contains the app itself. This is not so in OS X.</p><p></p></aside></div><div class="notebox"><aside><a name="//apple_ref/doc/uid/TP40010543-CH2-SW19" title="iCloud Note"></a><p><strong>iCloud Note:</strong>&nbsp;Apple’s iCloud technology, as described in <span class="content_text"><!--a target="_self" -->iCloud Storage<!--/a--></span>, uses the name “container” as well. There is no functional connection between an iCloud container and an App Sandbox container.</p><p></p></aside></div><p>Your sandboxed app can access paths outside of its container in the following three ways:</p><ul class="ul"><li class="li"><p>At the specific direction of the user</p></li><li class="li"><p>By you configuring your app with entitlements for specific file-system locations, such as the Movies folder</p></li><li class="li"><p>When a path is in any of certain directories that are world readable</p></li></ul><p>The OS X security technology that interacts with the user to expand your sandbox is called <em class="newTerm">Powerbox</em>. Powerbox has no API. Your app uses Powerbox transparently when, for example, you use the <code><a href="https://developer.apple.com/reference/appkit/nsopenpanel" target="_self" class="urlLink">NSOpenPanel</a></code> and <code><a href="https://developer.apple.com/reference/appkit/nssavepanel" target="_self" class="urlLink">NSSavePanel</a></code> classes, or when the user employs drag and drop with your app.</p><p>Some app operations are more likely to be targets of malicious exploitation. Examples are the parsing of data received over a network, and the decoding of video frames. By using XPC, you can improve the effectiveness of the damage containment offered by App Sandbox by separating such potentially dangerous activities into their own address spaces.</p><p><em class="newTerm">XPC</em> is an OS X interprocess communication technology that complements App Sandbox by enabling privilege separation. <em class="newTerm">Privilege separation</em>, in turn, is a development strategy in which you divide an app into pieces according to the system resource access that each piece needs. The component pieces that you create are called <em>XPC services</em>. For details on adopting XPC, see <em><a href="../../../../MacOSX/Conceptual/BPSystemStartup/Chapters/Introduction.html#//apple_ref/doc/uid/10000172i" data-renderer-version="1" target="_self">Daemons and Services Programming Guide</a></em>.</p><p>For a complete explanation of App Sandbox and how to use it, read <em><a href="../../../../Security/Conceptual/AppSandboxDesignGuide/AboutAppSandbox/AboutAppSandbox.html#//apple_ref/doc/uid/TP40011183" data-renderer-version="1" target="_self">App Sandbox Design Guide</a></em>.</p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW8" title="Code Signing"></a><h4 class="jump">Code Signing</h4><p>OS X employs the security technology known as <span class="pediaLink" data-header="Application Code Signing" data-contents="Signing an application allows the system to identify who signed the application and to verify that the application has not been modified since it was signed. "><a href="../../DevPedia-CocoaCore/AppSigning.html#//apple_ref/doc/uid/TP40008195-CH63" data-renderer-version="1" target="_self">code signing</a></span> to allow you to certify that your app was indeed created by you. After an app is code signed, the system can detect any change to the app—whether the change is introduced accidentally or by malicious code. Various security technologies, including App Sandbox and parental controls, depend on code signing.</p><p>In most cases, you can rely on Xcode’s automatic code signing, which requires only that you specify a code signing identity in the build settings for your project. The steps to take are described in <span class="content_text"><!--a target="_self" -->Code Signing Your App<!--/a--></span> in <em><!--a target="_self" -->Tools Workflow Guide for Mac<!--/a--></em>. If you need to incorporate code signing into an automated build system, or if you link your app against third-party frameworks, refer to the procedures described in <em><a href="../../../../Security/Conceptual/CodeSigningGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40005929" data-renderer-version="1" target="_self">Code Signing Guide</a></em>.</p><p>When you adopt App Sandbox, you must code sign your app. This is because entitlements (including the special entitlement that enables App Sandbox) are built into an app’s code signature.</p><p>OS X enforces a tie between an app’s container and the app’s code signature. This important security feature ensures that no other sandboxed app can access your container. The mechanism works as follows: After the system creates a container for an app, each time an app with the same bundle ID launches, the system checks that the app’s code signature matches a code signature expected by the container. If the system detects a mismatch, it prevents the app from launching.</p><p>For a complete explanation of code signing in the context of App Sandbox, read <span class="content_text"><a href="../../../../Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html#//apple_ref/doc/uid/TP40011183-CH3" data-renderer-version="1" target="_self">App Sandbox in Depth</a></span> in <em><a href="../../../../Security/Conceptual/AppSandboxDesignGuide/AboutAppSandbox/AboutAppSandbox.html#//apple_ref/doc/uid/TP40011183" data-renderer-version="1" target="_self">App Sandbox Design Guide</a></em>.</p></section><section><a name="//apple_ref/doc/uid/TP40010543-CH2-SW17" title="The Keychain"></a><h4 class="jump">The Keychain</h4><p>A keychain is a secure, encrypted container for storing a user’s passwords and other secrets. It is designed to help a user manage their multiple logins, each with its own ID and password. You should always use keychain to store sensitive credentials for your app.</p><p>For more on the keychain, see <span class="content_text"><a href="../../../../Security/Conceptual/keychainServConcepts/02concepts/concepts.html#//apple_ref/doc/uid/TP30000897-CH204" data-renderer-version="1" target="_self">Keychain Services Concepts</a></span> in <em><a href="../../../../Security/Conceptual/keychainServConcepts/01introduction/introduction.html#//apple_ref/doc/uid/TP30000897" data-renderer-version="1" target="_self">Keychain Services Programming Guide</a></em>.</p></section></section></section>
        <div id="pageNavigationLinks_bottom" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../CoreAppDesign/CoreAppDesign.html'>Next</a><a class='previousLink' rel='prev' href='../Introduction/Introduction.html'>Previous</a>
        </div><br/>
        <div class="copyright"><br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> Copyright &#x00a9; 2015 Apple Inc. All Rights Reserved. <a href="http://www.apple.com/legal/internet-services/terms/site.html" target="_blank">Terms of Use</a>   |  <a href="http://www.apple.com/privacy/" target="_blank">Privacy Policy</a>  |  Updated: 2015-03-09</p></div></div>

        <div id="pediaWindow">
            <div id="pediaHeader"></div>
            <div id="pediaBody"></div>
        </div>
    </article>

    <div id="blackout">
    <div id="preload"></div>
</div>
<div id="leave_feedback" class="button" role="button" tabindex="0">Feedback</div>
<div id="modal" aria-hidden="true">
    <div id="closebox" tabindex="0" aria-label="Close feedback form" role="button"></div>
    <div id="sending" class="hidden">
        <h2 tabindex="0">Sending feedback&hellip;</h2>
        <div id="sending_img"></div>
    </div>
    <div id="error" class="hidden">
        <h2 tabindex="0">We&rsquo;re sorry, an error has occurred.</h2>
        <p>Please try submitting your feedback later.</p>
        <div id="error_icon"></div>
    </div>
    <div id="success" class="hidden">
        <h2 tabindex="0">Thank you for providing feedback!</h2>
        <p>Your input helps improve our developer documentation.</p>
        <div id="thank_you_icon"></div>
    </div>
    
    <form id="feedback" action="#" method="post">
        <div class="left-leaf">
            <h2 id="helpful_title" data-asterisk="a1" tabindex="0">How helpful is this document?</h2>     
            <sup id="a1" class="asterisk" aria-hidden="true">*</sup>

            <div id="star_group" role="radiogroup" aria-required="true">
                <label> 
                    <input class="radio" type="radio" name="helped" value="1" /> 
                    Very helpful
                </label>
                <label> 
                    <input class="radio" type="radio" name="helped" value="2" /> 
                    Somewhat helpful
                </label>
                <label>
                    <input class="radio" type="radio" name="helped" value="3" /> 
                    Not helpful
                </label>
            </div>
        </div>
        <div class="right-leaf">
            <h2>How can we improve this document?</h2>
            <div id="improve" class="checkboxes">
                <label>
                    <input type="checkbox" name="typo" /> 
                    Fix typos or links
                </label>
                <label>
                    <input type="checkbox" name="infoIncorrect" /> 
                    Fix incorrect information
                </label>
                <label>
                    <input type="checkbox" name="needs_examples" /> 
                    Add or update code samples
                </label>
                <label>
                    <input type="checkbox" name="needs_art" /> 
                    Add or update illustrations
                </label>
                <label>
                    <input type="checkbox" name="missingInfo" /> 
                    Add information about...
                </label>
            </div>
        </div>

        <textarea id="comment" name="problem" cols="70" rows="8" placeholder="Please tell us more about your experience with this document" data-asterisk="a2" required></textarea>
        <sup id="a2" class="asterisk" aria-hidden="true">*</sup>

        <p class="fineprint">
            <em aria-hidden="true"><span>*</span> Required information</em>
        </p> 

        <input id="submit" type="button" value="Send" />

        <section id="legal">
            <p>
                To submit a product bug or enhancement request, please visit the 
                <a href="https://developer.apple.com/bugreporter/" target="_blank">Bug Reporter</a> 
                page.
            </p>
            <p>
                Please read <a href="http://www.apple.com/legal/policies/ideas.html" target="_blank">Apple's Unsolicited Idea Submission Policy</a> 
                before you send us your feedback.
            </p> 
        </section>
    </form>
</div>

    
    <script charset="utf-8" src="../../../../../Resources/1260/JavaScript/lib/prototype.js"></script>
    <script src="../../../../../Resources/1260/JavaScript/library.js"></script>
    <script src="../../../../../Resources/1260/JavaScript/feedback.js"></script>
</body>
</html>

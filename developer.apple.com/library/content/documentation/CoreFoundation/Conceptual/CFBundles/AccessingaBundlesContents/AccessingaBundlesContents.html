<!DOCTYPE html>
<html lang="en">
<head>
    <title>Accessing a Bundle’s Contents</title>
    <meta http-equiv="X-UA-Compatible" content="IE=7">
    <meta charset="utf-8">
    <meta id="book-resource-type" name="book-resource-type" content="Guide">
    <meta scheme="apple_ref" id="identifier" name="identifier" content="//apple_ref/doc/uid/10000123i">
    <meta id="document-version" name="document-version" content="6.7.0">
    <meta id="build" name="build" content="ded95564c405529dbbbe590063edd114" />
    <meta id="chapterId" name="chapterId" content="10000123i-CH104">
    <meta id="date" name="date" content="2017-03-21">
    <meta id="description" name="description" content="Explains how to use bundle objects to organize resources.">
    <meta id="book-title" name="book-title" content="Bundle Programming Guide">
    <meta id="book-root" name="book-root" content="../">
    <meta id="book-json" name="book-json" content="../book.json">
    <meta id="devcenter" name="devcenter" content="Mac Dev Center">
    <meta id="devcenter-url" name="devcenter-url" content="http://developer.apple.com/devcenter/mac">
    <meta id="reflib" name="reflib" content="Guides and Sample Code">
    <meta id="book-assignments" name="book-assignments" content="{Type/Guide}, {Topic/Data Management/File Management}">
    
    
    <meta id="copyright" name="copyright" content="Copyright 2017 Apple Inc. All Rights Reserved.">
    <meta id="xcode-display" name="xcode-display" content="render">
    <meta id="IndexTitle" name="IndexTitle" content="Bundle Programming Guide: Accessing a Bundle’s Contents">
    <meta id="resources-uri" name="resources-uri" content="../../../../../Resources/1260">
    <link id="book-index-page" rel="Start" title="Bundle Programming Guide" type="text/html" href="../index.html">
    <link id="next-page" rel="Next" type="text/html" href="../DocumentPackages/DocumentPackages.html">
    <link id="previous-page" rel="Prev" type="text/html" href="../BundleTypes/BundleTypes.html">
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1260/CSS/screen.css">
    
    <!-- xcode_css -->
    <link rel="stylesheet" type="text/css" href="../../../../../Resources/1260/CSS/feedback.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<meta id="platforms" name="platforms" content="">
</head>    
<body><a name="//apple_ref/doc/uid/10000123i-CH104" title="Accessing a Bundle’s Contents"></a>
    <div id="_omniture_top">
    <!-- SiteCatalyst code version: H.8. Copyright 1997-2006 Omniture, Inc. -->
    <script type="text/javascript">
    /* RSID: */
    var s_account="appleglobal,appleusdeveloper,dappdeveloperlib"
    </script>

    <script type="text/javascript" src="https://www.apple.com/metrics/scripts/s_code_h.js"></script>
    <script type="text/javascript">
    s.pageName=AC.Tracking.pageName();
    s.channel="www.us.developer"

    /************* DO NOT ALTER ANYTHING BELOW THIS LINE ! **************/
    var s_code=s.t();if(s_code)document.write(s_code)</script>
    <!-- End SiteCatalyst code version: H.8. -->
    </div>

    <div id="adcHeader" class="hideOnPrint hideInXcode">
        <div id='ssi_Header' class="hideInXcode unified">
            <a id="ssi_LibraryTitle" href='../../../../../navigation/'>Guides and Sample Code</a>
            <a id="ssi_AppleDeveloperConnection" href='https://developer.apple.com/'>Developer</a>
            <div id='ssi_SearchButton' role="button" title="Search">Search</div>
        </div>
        <form id='ssi_SearchMenu' method='get' action='../../../../../search/' accept-charset='utf-8'>
            <label for='adcsearch'>Search Guides and Sample Code</label>
            
            
    
            <input type='search' id='ssi_SearchField' name='q' accesskey='s' results='5' />
        </form>
    </div>

    <header id="header">
        <div id="title" role="banner">
            <h1>Bundle Programming Guide</h1>
            <span id="file_links">
                <a id="PDF_link" role="button" tabindex='4' rel="alternate" title="Download PDF"><span id="pdf_icon"></span>PDF</a>
                <a id="Companion_link" role="button" tabindex='3' title="Download Companion File"><span id="companion_icon"></span>Companion File</a>
            </span>
        </div>
        <ul id="headerButtons" class="hideOnPrint" role="toolbar">
            <li id="toc_button" style="display:none">
                <button tabindex="5" id="table_of_contents" class="open" role="checkbox" aria-label="Show Table of Contents"><span class="disclosure"></span>Table of Contents</button>
            </li>
            <li id="jumpto_button" style="display:none" role="navigation"><select tabindex="6" id="jumpTo"><option value="top">Jump To&#133;</option></select></li>
            <li id="downloadSample_button" style="display:none">
                <a id="Sample_link"><button id="Sample_button">Download Sample Code</button></a>
            </li>
        </ul>
    </header>
    <nav id="tocContainer" tabindex="7">
        <ul id="toc" role="tree"></ul>
    </nav>

    <article id="contents" tabindex="0" role="main">
        <div id="pageNavigationLinks_top" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../DocumentPackages/DocumentPackages.html'>Next</a><a class='previousLink' rel='prev' href='../BundleTypes/BundleTypes.html'>Previous</a>
        </div>
        <a id="top" name="top"></a>
        <a id="INDEX" href="../index.html" style="display:none;"></a>
        
        <a name="//apple_ref/doc/uid/10000123i-CH104-SW1" title="Accessing a Bundle’s Contents"></a><h1 id="pageTitle">Accessing a Bundle’s Contents</h1><p>When writing bundle-based code, you never use string constants to refer to the location of files in your bundle. Instead, you use the <code><a href="https://developer.apple.com/reference/foundation/bundle" target="_self" class="urlLink">NSBundle</a></code> class or <code><a href="https://developer.apple.com/reference/corefoundation/cfbundle" target="_self" class="urlLink">CFBundleRef</a></code> opaque type to obtain the path to the file you want. The reason is that the path to the desired file can vary depending on the user’s native language and the bundle’s supported localizations. By letting the bundle determine the location of the file, you are always assured of loading the correct file. </p><p>This chapter shows you how to use the <code>NSBundle</code> class and <code>CFBundleRef</code> opaque type to locate files and obtain other information about your bundle. Although these types are not directly interchangeable, they provide comparable features. And at least in Objective-C applications, you can use whichever type suits your needs.</p><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW6" title="Locating and Opening Bundles"></a><h2 class="jump">Locating and Opening Bundles</h2><p>Before you can access a bundle’s resources, you must first obtain an appropriate <code><a href="https://developer.apple.com/reference/foundation/bundle" target="_self" class="urlLink">NSBundle</a></code> object or <code><a href="https://developer.apple.com/reference/corefoundation/cfbundle" target="_self" class="urlLink">CFBundleRef</a></code> opaque type. The following sections outline the different ways you can get a reference to one of these types.</p><section><a name="//apple_ref/doc/uid/10000123i-CH104-123785" title="Getting the Main Bundle"></a><h3 class="jump">Getting the Main Bundle</h3><p>The main bundle is the bundle that contains the code and resources for the running application. If you are an application developer, this is the most commonly used bundle. The main bundle is also the easiest to retrieve because it does not require you to provide any information. </p><p>To get the main bundle in a Cocoa application, call the <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1410786-mainbundle" target="_self" class="urlLink">mainBundle</a></code> class method of the <code>NSBundle</code> class, as shown in <span class="content_text">Listing 3-1</span>.</p><a name="//apple_ref/doc/uid/10000123i-CH104-124660-BCIHBCAH" title="Listing 3-1Getting a reference to the main bundle using Cocoa"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-124660" title="Listing 3-1Getting a reference to the main bundle using Cocoa"></a><strong class="caption_number">Listing 3-1</strong>&nbsp;&nbsp;Getting a reference to the main bundle using Cocoa</p><div class="codesample clear"><table><tr><td scope="row"><pre>NSBundle* mainBundle;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Get the main bundle for the app.<span></span></pre></td></tr><tr><td scope="row"><pre>mainBundle = [NSBundle mainBundle];<span></span></pre></td></tr></table></div><p>If you are writing a C-based application, you can use the <code><a href="https://developer.apple.com/reference/corefoundation/1537085-cfbundlegetmainbundle" target="_self" class="urlLink">CFBundleGetMainBundle</a></code> function to retrieve the main bundle for your application, as shown in <span class="content_text">Listing 3-2</span>.</p><a name="//apple_ref/doc/uid/10000123i-CH104-123596-TPXREF113" title="Listing 3-2Getting a reference to the main bundle using Core Foundation"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-123596" title="Listing 3-2Getting a reference to the main bundle using Core Foundation"></a><strong class="caption_number">Listing 3-2</strong>&nbsp;&nbsp;Getting a reference to the main bundle using Core Foundation</p><div class="codesample clear"><table><tr><td scope="row"><pre>CFBundleRef mainBundle;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Get the main bundle for the app<span></span></pre></td></tr><tr><td scope="row"><pre>mainBundle = CFBundleGetMainBundle();<span></span></pre></td></tr></table></div><p>When getting the main bundle, it is still a good idea to make sure the value you get back represents a valid bundle. When retrieving the main bundle from any application, the returned value might be <code>NULL</code> in the following situations:</p><ul class="ul"><li class="li"><p>If a program is not bundled, attempting to get the main bundle might return a <code>NULL</code> value. The bundle code may try to create a main bundle to represent your program’s contents, but doing so is not possible in all cases. </p></li><li class="li"><p>If the agent that launched the program did not specify the full path to the program's executable in the <code>argv</code> parameters, the main bundle value might be <code>NULL</code>. Bundles rely on either the path to the executable being in <code>argv[0]</code> or the presence of the executable's path in the <code>PATH</code> environment variable. If neither of these is present, the bundle routines might not be able to find the main bundle directory. Programs launched by <code>xinetd</code> often experience this problem when <code>xinetd</code> changes the current directory to <code>/</code>. </p></li></ul></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123202" title="Getting Bundles by Path"></a><h3 class="jump">Getting Bundles by Path</h3><p>If you want to access a bundle other than the main bundle, you can create an appropriate bundle object if you know the path to the bundle directory. Creating a bundle by path is useful in situations where you are defining frameworks or other loadable bundles and know in advance where those bundles will be located.  </p><p>To obtain the bundle at a specific path using Cocoa, call the <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1495012-bundlewithpath" target="_self" class="urlLink">bundleWithPath:</a></code> class method of the <code>NSBundle</code> class. (You can also use the <code><a href="https://developer.apple.com/reference/foundation/bundle/1412741-init" target="_self" class="urlLink">initWithPath:</a></code> instance method to initialize a new bundle object.) This method takes a string parameter representing the full path to the bundle directory. <span class="content_text">Listing 3-3</span> shows an example that accesses a bundle in a local directory. </p><a name="//apple_ref/doc/uid/10000123i-CH104-124767-BCIDECED" title="Listing 3-3Locating a Cocoa bundle using its path"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-124767" title="Listing 3-3Locating a Cocoa bundle using its path"></a><strong class="caption_number">Listing 3-3</strong>&nbsp;&nbsp;Locating a Cocoa bundle using its path</p><div class="codesample clear"><table><tr><td scope="row"><pre>NSBundle* myBundle;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Obtain a reference to a loadable bundle.<span></span></pre></td></tr><tr><td scope="row"><pre>myBundle = [NSBundle bundleWithPath:@"/Library/MyBundle.bundle"];<span></span></pre></td></tr></table></div><p>To obtain the bundle at a specific path using Core Foundation, call the <code><a href="https://developer.apple.com/reference/corefoundation/1537154-cfbundlecreate" target="_self" class="urlLink">CFBundleCreate</a></code> function. When specifying the path location in Core Foundation, you must do so using a <code>CFURLRef</code> type. <span class="content_text">Listing 3-4</span> shows an example that takes the fixed directory from the preceding example, converts it to a URL, and uses that URL to access the bundle. </p><a name="//apple_ref/doc/uid/10000123i-CH104-124088-BBCCJBAF" title="Listing 3-4Locating a Core Foundation bundle using its path"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-124088" title="Listing 3-4Locating a Core Foundation bundle using its path"></a><strong class="caption_number">Listing 3-4</strong>&nbsp;&nbsp;Locating a Core Foundation bundle using its path</p><div class="codesample clear"><table><tr><td scope="row"><pre>CFURLRef bundleURL;<span></span></pre></td></tr><tr><td scope="row"><pre>CFBundleRef myBundle;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Make a CFURLRef from the CFString representation of the<span></span></pre></td></tr><tr><td scope="row"><pre>// bundle’s path.<span></span></pre></td></tr><tr><td scope="row"><pre>bundleURL = CFURLCreateWithFileSystemPath(<span></span></pre></td></tr><tr><td scope="row"><pre>                kCFAllocatorDefault,<span></span></pre></td></tr><tr><td scope="row"><pre>                CFSTR("/Library/MyBundle.bundle"),<span></span></pre></td></tr><tr><td scope="row"><pre>                kCFURLPOSIXPathStyle,<span></span></pre></td></tr><tr><td scope="row"><pre>                true );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Make a bundle instance using the URLRef.<span></span></pre></td></tr><tr><td scope="row"><pre>myBundle = CFBundleCreate( kCFAllocatorDefault, bundleURL );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// You can release the URL now.<span></span></pre></td></tr><tr><td scope="row"><pre>CFRelease( bundleURL );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Use the bundle...<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Release the bundle when done.<span></span></pre></td></tr><tr><td scope="row"><pre>CFRelease( myBundle );<span></span></pre></td></tr></table></div></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-125088" title="Getting Bundles in Known Directories"></a><h3 class="jump">Getting Bundles in Known Directories</h3><p>Even if you do not know the exact path to a bundle, you can still search for it in some known location. For example, an application with a <code>PlugIns</code> directory might want to get a list of all the bundles in that directory. Once you have the path to the directory, you can use the appropriate routines to iterate that directory and return any bundles.</p><p>The simplest way to find all of the bundles in a specific directory is to use the <code><a href="https://developer.apple.com/reference/corefoundation/1537125-cfbundlecreatebundlesfromdirecto" target="_self" class="urlLink">CFBundleCreateBundlesFromDirectory</a></code> function. This function returns new <code>CFBundleRef</code> types for all of the bundles in a given directory. <span class="content_text">Listing 3-5</span> shows how you would use this function to retrieve all of the plug-ins in the application’s <code>PlugIns</code> directory. </p><a name="//apple_ref/doc/uid/10000123i-CH104-125268-TPXREF114" title="Listing 3-5Obtaining bundle references for a set of plug-ins"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-125268" title="Listing 3-5Obtaining bundle references for a set of plug-ins"></a><strong class="caption_number">Listing 3-5</strong>&nbsp;&nbsp;Obtaining bundle references for a set of plug-ins</p><div class="codesample clear"><table><tr><td scope="row"><pre>CFBundleRef mainBundle = CFBundleGetMainBundle();<span></span></pre></td></tr><tr><td scope="row"><pre>CFURLRef plugInsURL;<span></span></pre></td></tr><tr><td scope="row"><pre>CFArrayRef bundleArray;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Get the URL to the application’s PlugIns directory.<span></span></pre></td></tr><tr><td scope="row"><pre>plugInsURL = CFBundleCopyBuiltInPlugInsURL(mainBundle);<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Get the bundle objects for the application’s plug-ins.<span></span></pre></td></tr><tr><td scope="row"><pre>bundleArray = CFBundleCreateBundlesFromDirectory( kCFAllocatorDefault,<span></span></pre></td></tr><tr><td scope="row"><pre>                    plugInsURL, NULL );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Release the CF objects when done with them.<span></span></pre></td></tr><tr><td scope="row"><pre>CFRelease( plugInsURL );<span></span></pre></td></tr><tr><td scope="row"><pre>CFRelease( bundleArray );<span></span></pre></td></tr></table></div></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123081" title="Getting Bundles by Identifier"></a><h3 class="jump">Getting Bundles by Identifier</h3><p>Locating bundles using a bundle identifier is an efficient way to locate bundles that were previously loaded into memory. A bundle identifier is the string assigned to the <code>CFBundleIdentifier</code> key in the bundle’s <code>Info.plist</code> file. This string is typically formatted using reverse-DNS notation so as to prevent name space conflicts with developers in other companies. For example, a Finder plug-in from Apple might use the string <code>com.apple.Finder.MyGetInfoPlugin</code> as its bundle identifier. Rather than passing a pointer to a bundle object around your code, clients that need a reference to a bundle can simply use the bundle identifier to retrieve it. </p><p>To retrieve a bundle using a bundle identifier in Cocoa, call the <code><a href="https://developer.apple.com/reference/foundation/bundle/1411929-init" target="_self" class="urlLink">bundleWithIdentifier:</a></code> class method of the <code>NSBundle</code> class, as shown in <span class="content_text">Listing 3-6</span>.</p><a name="//apple_ref/doc/uid/10000123i-CH104-SW3" title="Listing 3-6Locating a bundle using its identifier in Cocoa"></a><p class="codesample clear"><strong class="caption_number">Listing 3-6</strong>&nbsp;&nbsp;Locating a bundle using its identifier in Cocoa</p><div class="codesample clear"><table><tr><td scope="row"><pre>NSBundle* myBundle = [NSBundle bundleWithIdentifier:@"com.apple.myPlugin"];<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 3-7</span> shows how to retrieve a bundle using its bundle identifier in Core Foundation. </p><a name="//apple_ref/doc/uid/10000123i-CH104-123159-TPXREF115" title="Listing 3-7Locating a bundle using its identifier in Core Foundation"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001123-123159" title="Listing 3-7Locating a bundle using its identifier in Core Foundation"></a><strong class="caption_number">Listing 3-7</strong>&nbsp;&nbsp;Locating a bundle using its identifier in Core Foundation</p><div class="codesample clear"><table><tr><td scope="row"><pre>CFBundleRef requestedBundle;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre> // Look for a bundle using its identifier<span></span></pre></td></tr><tr><td scope="row"><pre> requestedBundle = CFBundleGetBundleWithIdentifier(<span></span></pre></td></tr><tr><td scope="row"><pre>        CFSTR("com.apple.Finder.MyGetInfoPlugIn") );<span></span></pre></td></tr></table></div><p>Remember that you can only use a bundle identifier to locate a bundle that has already been opened. For example, you could use this technique to open the main bundle and bundles for all statically linked frameworks. You could not use this technique to get a reference to a plug-in that had not yet been loaded.  </p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123639" title="Searching for Related Bundles"></a><h3 class="jump">Searching for Related Bundles</h3><p>If you are writing a Cocoa application, you can obtain a list of bundles related to the application by calling the <code><a href="https://developer.apple.com/reference/foundation/bundle/1413705-allbundles" target="_self" class="urlLink">allBundles</a></code> and <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1408056-allframeworks" target="_self" class="urlLink">allFrameworks</a></code> class methods of <code>NSBundle</code>. These methods create an array of <code>NSBundle</code> objects corresponding to the bundles or frameworks currently in use by your application. You can use these methods as convenience functions rather than maintain a collection of loaded bundles yourself. </p><p>The <code><a href="https://developer.apple.com/reference/foundation/bundle/1417717-init" target="_self" class="urlLink">bundleForClass:</a></code> class method is another way get related bundle information in a Cocoa application. This method returns the bundle in which a particular class is defined. Again, this method is mostly for convenience so that you do not have to retain a pointer to an <code>NSBundle</code> object that you may use only occasionally. </p></section></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW2" title="Getting References to Bundle Resources"></a><h2 class="jump">Getting References to Bundle Resources</h2><p>If you have a reference to a bundle object, you can use that object to determine the location of resources inside the bundle. Cocoa and Core Foundation both provide different ways of locating resources inside a bundle. In addition, you should understand how those frameworks look for resource files within your bundle so as to make sure you put files in the right places at build time. </p><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW7" title="The Bundle Search Pattern"></a><h3 class="jump">The Bundle Search Pattern</h3><p>As long as you use an <code><a href="https://developer.apple.com/reference/foundation/bundle" target="_self" class="urlLink">NSBundle</a></code> object or a <code><a href="https://developer.apple.com/reference/corefoundation/cfbundle" target="_self" class="urlLink">CFBundleRef</a></code> opaque type to locate resources, your bundle code need never concern itself with how resources are retrieved from a bundle. Both <code>NSBundle</code> and <code>CFBundleRef</code> retrieve the appropriate language-specific resource automatically based on the available user settings and bundle configuration. However, you still have to put all those language-specific resources into your bundle, so knowing how they are retrieved is important.</p><p>The bundle programming interfaces follow a specific search algorithm to locate resources within the bundle. Global resources have the highest priority, followed by region- and language-specific resources. When considering region- and language-specific resources, the algorithm takes into account both the settings for the current user and development region information in the bundle’s <code>Info.plist</code> file. </p><p>First, the bundle determines which localization to use for the application as a whole. If a <code>.lproj</code> folder exists for the preferred language, that localization is used. Otherwise, the bundle searches for an <code>.lproj</code> folder matching the next preferred language, and so on, until one is found. If there is no localization for a preferred language, the bundle chooses the development language localization.</p><p>Then the bundle searches for the resource in the following order:</p><ol class="ol"><li class="li"><p>Global (nonlocalized) resources</p></li><li class="li"><p>Region-specific localized resources (based on the user’s region preferences)</p></li><li class="li"><p><span class="pediaLink" data-header="Internationalization" data-contents="Internationalization is the process of designing a software application so that it can be adapted to various languages and regions without engineering changes. "><a href="../../../../General/Conceptual/DevPedia-CocoaCore/Internationalization.html#//apple_ref/doc/uid/TP40008195-CH23" data-renderer-version="1" target="_self">Language-specific localized resources</a></span> (based on the user’s language preferences) </p></li><li class="li"><p>Development language resources (as specified by the <code>CFBundleDevelopmentRegion</code> in the bundle’s <code>Info.plist</code> file.)</p></li></ol><div class="importantbox clear"><aside><a name="//apple_ref/doc/uid/10000123i-CH104-DontLinkElementID_5" title="Important"></a><p><strong>Important:</strong>&nbsp;The bundle interfaces consider case when searching for resource files in the bundle directory. This case-sensitive search occurs even on file systems (such as HFS+) that are not case sensitive when it comes to file names. </p><p></p></aside></div><p>Because global resources take precedence over language-specific resources, there should <em>never</em> be both a global and localized version of a given resource. If a global version of a resource exists, language-specific versions of the same resource are never returned. The reason for this precedence is performance. If localized resources were searched first, the bundle routines might search needlessly in several localized resource directories before discovering the global resource. </p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW16" title="Device-Specific Resources in iOS"></a><h3 class="jump">Device-Specific Resources in iOS</h3><p>In iOS 4.0 and later, it is possible to mark individual resource files as usable only on a specific type of device. This capability simplifies the code you have to write for Universal applications. Rather than creating separate code paths to load one version of a resource file for iPhone and a different version of the file for iPad, you can let the bundle-loading routines choose the correct file. All you have to do is name your resource files appropriately.</p><p>To associate a resource file with a particular device, you add a custom modifier string to its filename. The inclusion of this modifier string yields filenames with the following format:</p><p><em>&lt;basename&gt;</em><em>&lt;device&gt;</em><code>.</code><em>&lt;filename_extension&gt;</em></p><p>The <em>&lt;basename&gt;</em> string represents the original name of the resource file. It also represents the name you use when accessing the file from your code. Similarly, the <em>&lt;filename_extension&gt;</em> string is the standard filename extension used to identify the type of the file. The <em>&lt;device&gt;</em> string is a case-sensitive string that can be one of the following values:</p><ul class="ul"><li class="li"><p><code>~ipad</code> - The resource should be loaded on iPad devices only.</p></li><li class="li"><p><code>~iphone</code> - The resource should be loaded on iPhone or iPod touch devices only.</p></li></ul><p>You can apply device modifiers to any type of resource file. For example, suppose you have an image named <code>MyImage.png</code>. To specify different versions of the image for iPad and iPhone, you would create resource files with the names <code>MyImage~ipad.png</code> and <code>MyImage~iphone.png</code> and include them both in your bundle. To load the image, you would continue to refer to the resource as <code>MyImage.png</code> in your code and let the system choose the appropriate version, as shown here:</p><div class="codesample clear"><table><tr><td scope="row"><pre>UIImage* anImage = [UIImage imageNamed:@"MyImage.png"];<span></span></pre></td></tr></table></div><p>On an iPhone or iPod touch device, the system loads the <code>MyImage~iphone.png</code> resource file, while on iPad, it loads the <code>MyImage~ipad.png</code> resource file. If a device-specific version of a resource is not found, the system falls back to looking for a resource with the original filename, which in the preceding example would be an image named <code>MyImage.png</code>.</p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW8" title="Getting the Path to a Resource"></a><h3 class="jump">Getting the Path to a Resource</h3><p>In order to locate a resource file in a bundle, you need to know the name of the file, its type, or a combination of the two. Filename extensions are used to identify the type of a file; therefore, it is important that your resource files include the appropriate extensions. If you used custom subdirectories in your bundle to organize resource files, you can speed up the search by providing the name of the subdirectory that contains the desired file.</p><p>Even if you do not have a bundle object, you can still search for resources in directories whose paths you know. Both Core Foundation and Cocoa provide API for searching for files using only path-based information. (For example, in Cocoa you can use the <code><a href="https://developer.apple.com/reference/foundation/nsfilemanager" target="_self" class="urlLink">NSFileManager</a></code> object to enumerate the contents of directories and test for the existence of files.) However, if you plan to retrieve more than one resource file, it is always faster to use a bundle object. Bundle objects cache search information as they go, so subsequent searches are usually faster.</p><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW9" title="Using Cocoa to Find Resources"></a><h4 class="jump">Using Cocoa to Find Resources</h4><p>If you have an <code>NSBundle</code> object, you can use the following methods to find the location of resources in that bundle:</p><ul class="simple"><li><p><code><a href="https://developer.apple.com/reference/foundation/nsbundle/1410989-pathforresource" target="_self" class="urlLink">pathForResource:ofType:</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/foundation/bundle/1409670-path" target="_self" class="urlLink">pathForResource:ofType:inDirectory:</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/foundation/bundle/1413471-path" target="_self" class="urlLink">pathForResource:ofType:inDirectory:forLocalization:</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/foundation/nsbundle/1413058-pathsforresourcesoftype" target="_self" class="urlLink">pathsForResourcesOfType:inDirectory:</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/foundation/nsbundle/1416940-pathsforresourcesoftype" target="_self" class="urlLink">pathsForResourcesOfType:inDirectory:forLocalization:</a></code></p></li></ul><p>Suppose you have placed an image called <code>Seagull.jpg</code> in your application’s main bundle. <span class="content_text">Listing 3-8</span> shows you how to retrieve the path for this image file from the application’s main bundle. </p><a name="//apple_ref/doc/uid/10000123i-CH104-SW4" title="Listing 3-8Finding a single resource file using NSBundle"></a><p class="codesample clear"><strong class="caption_number">Listing 3-8</strong>&nbsp;&nbsp;Finding a single resource file using <code>NSBundle</code></p><div class="codesample clear"><table><tr><td scope="row"><pre>NSBundle* myBundle = [NSBundle mainBundle];<span></span></pre></td></tr><tr><td scope="row"><pre>NSString* myImage = [myBundle pathForResource:@"Seagull" ofType:@"jpg"];<span></span></pre></td></tr></table></div><p>If you wanted to look for all image resources in your top-level resource directory, instead of looking for just a single resource, you could use the <code>pathsForResourcesOfType:inDirectory:</code> method or one of its equivalents, as shown in <span class="content_text">Listing 3-9</span></p><a name="//apple_ref/doc/uid/10000123i-CH104-SW5" title="Listing 3-9Finding multiple resources using NSBundle"></a><p class="codesample clear"><strong class="caption_number">Listing 3-9</strong>&nbsp;&nbsp;Finding multiple resources using <code>NSBundle</code></p><div class="codesample clear"><table><tr><td scope="row"><pre>NSBundle* myBundle = [NSBundle mainBundle];<span></span></pre></td></tr><tr><td scope="row"><pre>NSArray* myImages = [myBundle pathsForResourcesOfType:@"jpg"<span></span></pre></td></tr><tr><td scope="row"><pre>                              inDirectory:nil];<span></span></pre></td></tr></table></div></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW10" title="Using Core Foundation to Find Resources"></a><h4 class="jump">Using Core Foundation to Find Resources</h4><p>If you have a <code>CFBundleRef</code> opaque type, you can use the following methods to find the location of resources in that bundle:</p><ul class="simple"><li><p><code><a href="https://developer.apple.com/reference/corefoundation/1537117-cfbundlecopyresourceurl" target="_self" class="urlLink">CFBundleCopyResourceURL</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/corefoundation/1537138-cfbundlecopyresourceurlindirecto" target="_self" class="urlLink">CFBundleCopyResourceURLInDirectory</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/corefoundation/1537121-cfbundlecopyresourceurlsoftype" target="_self" class="urlLink">CFBundleCopyResourceURLsOfType</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/corefoundation/1537140-cfbundlecopyresourceurlsoftypein" target="_self" class="urlLink">CFBundleCopyResourceURLsOfTypeInDirectory</a></code></p></li><li><p><code><a href="https://developer.apple.com/reference/corefoundation/1537162-cfbundlecopyresourceurlsoftypefo" target="_self" class="urlLink">CFBundleCopyResourceURLsOfTypeForLocalization</a></code></p></li></ul><p>Suppose you have placed an image called <code>Seagull.jpg</code> in your application’s main bundle. <span class="content_text">Listing 3-10</span> shows you how to search for this image by name and type using the Core Foundation function <code>CFBundleCopyResourceURL</code>. In this case, the code looks for the file named “Seagull” with the file type (filename extension) of “jpg” in the bundle’s resource directory.</p><a name="//apple_ref/doc/uid/10000123i-CH104-123198-BBCDAAEE" title="Listing 3-10Finding a single resource using a CFBundleRef"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001125-123198" title="Listing 3-10Finding a single resource using a CFBundleRef"></a><strong class="caption_number">Listing 3-10</strong>&nbsp;&nbsp;Finding a single resource using a <code>CFBundleRef</code></p><div class="codesample clear"><table><tr><td scope="row"><pre>    CFURLRef    seagullURL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Look for a resource in the main bundle by name and type.<span></span></pre></td></tr><tr><td scope="row"><pre>    seagullURL = CFBundleCopyResourceURL( mainBundle,<span></span></pre></td></tr><tr><td scope="row"><pre>                    CFSTR("Seagull"),<span></span></pre></td></tr><tr><td scope="row"><pre>                    CFSTR("jpg"),<span></span></pre></td></tr><tr><td scope="row"><pre>                    NULL );<span></span></pre></td></tr></table></div><p>Suppose that instead of searching for one image file, you wanted to get the names of all image files in a directory called <code>BirdImages</code>. You could load all of the JPEGs in the directory using the function <code>CFBundleCopyResourceURLsOfType</code>, as shown in <span class="content_text">Listing 3-11</span>. </p><a name="//apple_ref/doc/uid/10000123i-CH104-123277-TPXREF118" title="Listing 3-11Finding multiple resources using a CFBundleRef"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001125-123277" title="Listing 3-11Finding multiple resources using a CFBundleRef"></a><strong class="caption_number">Listing 3-11</strong>&nbsp;&nbsp;Finding multiple resources using a <code>CFBundleRef</code></p><div class="codesample clear"><table><tr><td scope="row"><pre>    CFArrayRef  birdURLs;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Find all of the JPEG images in a given directory.<span></span></pre></td></tr><tr><td scope="row"><pre>    birdURLs = CFBundleCopyResourceURLsOfType( mainBundle,<span></span></pre></td></tr><tr><td scope="row"><pre>                    CFSTR("jpg"),<span></span></pre></td></tr><tr><td scope="row"><pre>                    CFSTR("BirdImages") );<span></span></pre></td></tr></table></div><div class="notebox"><aside><a name="//apple_ref/doc/uid/10000123i-CH104-SW11" title="Note"></a><p><strong>Note:</strong>&nbsp;You can search for resources that do not have a filename extension. To get the path to such a resource, specify the complete name of the resource and specify <code>NULL</code> for the resource type.</p><p></p></aside></div></section></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW12" title="Opening and Using Resource Files"></a><h3 class="jump">Opening and Using Resource Files</h3><p>Once you have a reference to a resource file, you can load its contents and use it in your application. The steps you must take to load and use resource files depends on the type of resource, and as such is not covered in this document. For detailed information about loading and using resources, see <em><a href="../../../../Cocoa/Conceptual/LoadingResources/Introduction/Introduction.html#//apple_ref/doc/uid/10000051i" data-renderer-version="1" target="_self">Resource Programming Guide</a></em>.</p></section></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123069" title="Finding Other Files in a Bundle"></a><h2 class="jump">Finding Other Files in a Bundle</h2><p>With a valid bundle object, you can retrieve the path to the top-level bundle directory as well as paths to many of its subdirectories. Using the available interfaces to retrieve directory paths insulates your code from having to know the exact structure of the bundle or its location in the system. It also allows you to use the same code on different platforms. For example, you could use the same code to retrieve resources from an iOS application or a Mac app, which have different bundle structures.</p><p>To get the path to the top-level bundle directory using Cocoa, you use the <code><a href="https://developer.apple.com/reference/foundation/bundle/1407973-bundlepath" target="_self" class="urlLink">bundlePath</a></code> method of the corresponding <code>NSBundle</code> object. You can also use the <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1408900-builtinpluginspath" target="_self" class="urlLink">builtInPlugInsPath</a></code>, <code><!--a target="_self" -->resourcePath<!--/a--></code>, <code><a href="https://developer.apple.com/reference/foundation/bundle/1417226-sharedframeworkspath" target="_self" class="urlLink">sharedFrameworksPath</a></code>, and <code><a href="https://developer.apple.com/reference/foundation/bundle/1411609-sharedsupportpath" target="_self" class="urlLink">sharedSupportPath</a></code> methods to obtain the paths for key subdirectories of the bundle. These methods return path information using an <code>NSString</code> object, which you can pass directly to most other <code>NSBundle</code> methods or convert to an <code>NSURL</code> object as needed. </p><p>Core Foundation also defines functions for retrieving several different internal bundle directories. To get the path of the bundle itself, you can use the <code><a href="https://developer.apple.com/reference/corefoundation/1537142-cfbundlecopybundleurl" target="_self" class="urlLink">CFBundleCopyBundleURL</a></code> function. You can also use the <code><a href="https://developer.apple.com/reference/corefoundation/1537106-cfbundlecopybuiltinpluginsurl" target="_self" class="urlLink">CFBundleCopyBuiltInPlugInsURL</a></code>, <code><a href="https://developer.apple.com/reference/corefoundation/1537113-cfbundlecopyresourcesdirectoryur" target="_self" class="urlLink">CFBundleCopyResourcesDirectoryURL</a></code>, <code><a href="https://developer.apple.com/reference/corefoundation/1537159-cfbundlecopysharedframeworksurl" target="_self" class="urlLink">CFBundleCopySharedFrameworksURL</a></code>, and <code><a href="https://developer.apple.com/reference/corefoundation/1537118-cfbundlecopysupportfilesdirector" target="_self" class="urlLink">CFBundleCopySupportFilesDirectoryURL</a></code> functions to obtain the locations of key subdirectories of the bundle. Core Foundation always returns bundle paths as a <code>CFURLRef</code> opaque type. You can use this type to extract a <code>CFStringRef</code> type that you can then pass to other Core Foundation routines. </p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123093" title="Getting the Bundle’s Info.plist Data"></a><h2 class="jump">Getting the Bundle’s Info.plist Data</h2><p>One file that every bundle should contain is an <span class="pediaLink" data-header="Property list" data-contents="A property list is a representation of a hierarchy of objects that can be stored in the file system and reconstituted later. "><a href="../../../../General/Conceptual/DevPedia-CocoaCore/PropertyList.html#//apple_ref/doc/uid/TP40008195-CH44" data-renderer-version="1" target="_self">information property list</a></span> (<code>Info.plist</code>) file. This file is an XML-based text file that contains specific types of key-value pairs. These key-value pairs specify information about the bundle, such as its ID string, version number, development region, type, and other important properties. (See <em><a href="../../../../MacOSX/Conceptual/BPRuntimeConfig/000-Introduction/introduction.html#//apple_ref/doc/uid/10000170i" data-renderer-version="1" target="_self">Runtime Configuration Guidelines</a></em> for the list of keys you can include in this file.) Bundles may also include other types of configuration data, mostly organized in XML-based property lists.</p><p>The <code>NSBundle</code> class provides the <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1408696-objectforinfodictionarykey" target="_self" class="urlLink">objectForInfoDictionaryKey:</a></code> and <code><a href="https://developer.apple.com/reference/foundation/nsbundle/1413477-infodictionary" target="_self" class="urlLink">infoDictionary</a></code> methods for retrieving information from the <code>Info.plist</code> file. The <code>objectForInfoDictionaryKey:</code> method returns the localized value for a key and is the preferred method to call. The <code>infoDictionary</code> method returns an <code>NSDictionary</code> with all of the keys from the property list; however, it does not return any localized values for these keys. For more information, see the <em><a href="https://developer.apple.com/reference/foundation/nsbundle" target="_self" class="urlLink">NSBundle Class Reference</a></em>. </p><p>Core Foundation also offers functions for retrieving specific pieces of data from a bundle’s information property list file, including the bundle’s ID string, version, and development region. You can retrieve the localized value for a key using the <code><a href="https://developer.apple.com/reference/corefoundation/1537102-cfbundlegetvalueforinfodictionar" target="_self" class="urlLink">CFBundleGetValueForInfoDictionaryKey</a></code> function. You can also retrieve the entire dictionary of non-localized keys using <code><a href="https://developer.apple.com/reference/corefoundation/1537165-cfbundlegetinfodictionary" target="_self" class="urlLink">CFBundleGetInfoDictionary</a></code>. For more information about these and related functions, see <em><a href="https://developer.apple.com/reference/corefoundation/cfbundle-s0a" target="_self" class="urlLink">CFBundle Reference</a></em>.</p><div class="notebox"><aside><a name="//apple_ref/doc/uid/10000123i-CH104-SW13" title="Note"></a><p><strong>Note:</strong>&nbsp;Because they take localized values into account, <code>CFBundleGetValueForInfoDictionaryKey</code> and <code>objectForInfoDictionaryKey:</code> are the preferred interfaces for retrieving keys.</p><p></p></aside></div><p><span class="content_text">Listing 3-12</span> demonstrates how to retrieve the bundle’s version number from the information property list using Core Foundation functions. Though the value in the information property list may be written as a string, for example “2.1.0b7”, the value is returned as an unsigned long integer. </p><a name="//apple_ref/doc/uid/10000123i-CH104-123208-TPXREF116" title="Listing 3-12Obtaining the bundle’s version"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001124-123208" title="Listing 3-12Obtaining the bundle’s version"></a><strong class="caption_number">Listing 3-12</strong>&nbsp;&nbsp;Obtaining the bundle’s version</p><div class="codesample clear"><table><tr><td scope="row"><pre>    // This is the ‘vers’ resource style value for 1.0.0<span></span></pre></td></tr><tr><td scope="row"><pre>    #define kMyBundleVersion1 0x01008000<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    UInt32  bundleVersion;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Look for the bundle’s version number.<span></span></pre></td></tr><tr><td scope="row"><pre>    bundleVersion = CFBundleGetVersionNumber( mainBundle );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Check the bundle version for compatibility with the app.<span></span></pre></td></tr><tr><td scope="row"><pre>    if (bundleVersion &lt; kMyBundleVersion1)<span></span></pre></td></tr><tr><td scope="row"><pre>        return (kErrorFatalBundleTooOld);<span></span></pre></td></tr></table></div><p><span class="content_text">Listing 3-13</span> shows you how to retrieve arbitrary values from the information property list using the <code>CFBundleGetInfoDictionary</code> function. The resulting information property list is an instance of the standard Core Foundation type <code><a href="https://developer.apple.com/reference/corefoundation/cfdictionary" target="_self" class="urlLink">CFDictionaryRef</a></code>. For more information about retrieving information from a Core Foundation dictionary, see <em><a href="https://developer.apple.com/reference/corefoundation/cfdictionary-rum" target="_self" class="urlLink">CFDictionary Reference</a></em>. </p><a name="//apple_ref/doc/uid/10000123i-CH104-123302-TPXREF117" title="Listing 3-13Retrieving information from a bundle’s information property list"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001124-123302" title="Listing 3-13Retrieving information from a bundle’s information property list"></a><strong class="caption_number">Listing 3-13</strong>&nbsp;&nbsp;Retrieving information from a bundle’s information property list</p><div class="codesample clear"><table><tr><td scope="row"><pre>    CFDictionaryRef bundleInfoDict;<span></span></pre></td></tr><tr><td scope="row"><pre>    CFStringRef     myPropertyString;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // Get an instance of the non-localized keys.<span></span></pre></td></tr><tr><td scope="row"><pre>    bundleInfoDict = CFBundleGetInfoDictionary( myBundle );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // If we succeeded, look for our property.<span></span></pre></td></tr><tr><td scope="row"><pre>    if ( bundleInfoDict != NULL ) {<span></span></pre></td></tr><tr><td scope="row"><pre>        myPropertyString = CFDictionaryGetValue( bundleInfoDict,<span></span></pre></td></tr><tr><td scope="row"><pre>                    CFSTR("MyPropertyKey") );<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>It is also possible to obtain an instance of a bundle’s information dictionary without a bundle object. To do this you use either the Core Foundation function <code><a href="https://developer.apple.com/reference/corefoundation/1537135-cfbundlecopyinfodictionaryindire" target="_self" class="urlLink">CFBundleCopyInfoDictionaryInDirectory</a></code> or the Cocoa <code><a href="https://developer.apple.com/reference/foundation/nsdictionary" target="_self" class="urlLink">NSDictionary</a></code> class. This can be useful for searching the information property lists of a set of bundles without first creating bundle objects.</p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-SW14" title="Loading and Unloading Executable Code"></a><h2 class="jump">Loading and Unloading Executable Code</h2><p>The key to loading code from an external bundle is finding an appropriate entry point into the bundle’s executable file. As with other plug-in schemes, this requires some coordination between the application developer and the plug-in developer. You can publish a custom API for bundles to implement or define a formal plug-in interface. In either case, once you have an appropriate bundle or plug-in, you use the <code>NSBundle</code> class (or the <code>CFBundleRef</code> opaque type) to access the functions or classes implemented by the external code. </p><div class="notebox"><aside><a name="//apple_ref/doc/uid/10000123i-CH104-SW15" title="Note"></a><p><strong>Note:</strong>&nbsp;Another option for loading Mach-O code directly is to use the <code>NSModule</code> loading routines. However, these routines typically require more work to use and are less preferable than the <code>NSBundle</code> or <code>CFBundleRef</code> interfaces. For more information, see <em><!--a target="_self" -->OS X ABI Mach-O File Format Reference<!--/a--></em> or see the <code>NSModule</code> man pages.</p><p></p></aside></div><p>For additional information about loading and unloading code, see <em><a href="../../../../Cocoa/Conceptual/LoadingCode/LoadingCode.html#//apple_ref/doc/uid/10000052i" data-renderer-version="1" target="_self">Code Loading Programming Topics</a></em>. </p><section><a name="//apple_ref/doc/uid/10000123i-CH104-122736" title="Loading Functions"></a><h3 class="jump">Loading Functions</h3><p>If you are working in C, C++, or even in <span class="pediaLink" data-header="Objective-C" data-contents="Objective-C defines a small but powerful set of extensions to the ANSI  C programming language that enables sophisticated object-oriented programming. "><a href="../../../../General/Conceptual/DevPedia-CocoaCore/ObjectiveC.html#//apple_ref/doc/uid/TP40008195-CH43" data-renderer-version="1" target="_self">Objective-C</a></span>, you can publish your interface as a set of C-based symbols, such as function pointers and global variables. Using the Core Foundation functions, you can load references to those symbols from a bundle’s executable file.</p><p>You can retrieve symbols using any of several functions. To retrieve function pointers, call either <code><a href="https://developer.apple.com/reference/corefoundation/1537143-cfbundlegetfunctionpointerfornam" target="_self" class="urlLink">CFBundleGetFunctionPointerForName</a></code> or <code><a href="https://developer.apple.com/reference/corefoundation/1537109-cfbundlegetfunctionpointersforna" target="_self" class="urlLink">CFBundleGetFunctionPointersForNames</a></code>. To retrieve a pointer to a global variable, call <code><a href="https://developer.apple.com/reference/corefoundation/1537120-cfbundlegetdatapointerforname" target="_self" class="urlLink">CFBundleGetDataPointerForName</a></code> or <code><a href="https://developer.apple.com/reference/corefoundation/1537150-cfbundlegetdatapointersfornames" target="_self" class="urlLink">CFBundleGetDataPointersForNames</a></code>. For example, suppose a loadable bundle defines the function shown in <span class="content_text">Listing 3-14</span>.</p><a name="//apple_ref/doc/uid/10000123i-CH104-123576-TPXREF119" title="Listing 3-14An example function for a loadable bundle"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001127-123576" title="Listing 3-14An example function for a loadable bundle"></a><strong class="caption_number">Listing 3-14</strong>&nbsp;&nbsp;An example function for a loadable bundle</p><div class="codesample clear"><table><tr><td scope="row"><pre>    // Add one to the incoming value and return it.<span></span></pre></td></tr><tr><td scope="row"><pre>    long addOne(short number)<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        return ( (long)number + 1 );<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr></table></div><p>Given a <code>CFBundleRef</code> opaque type, you would need to search for the desired function before you could use it in your code. <span class="content_text">Listing 3-15</span> shows a code fragment that illustrates this process. In this example, the <code>myBundle</code> variable is a <code>CFBundleRef</code> opaque type pointing to the bundle.</p><a name="//apple_ref/doc/uid/10000123i-CH104-122848-TPXREF120" title="Listing 3-15Finding a function in a loadable bundle"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001127-122848" title="Listing 3-15Finding a function in a loadable bundle"></a><strong class="caption_number">Listing 3-15</strong>&nbsp;&nbsp;Finding a function in a loadable bundle</p><div class="codesample clear"><table><tr><td scope="row"><pre>// Function pointer.<span></span></pre></td></tr><tr><td scope="row"><pre>AddOneFunctionPtr addOne = NULL;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Value returned from the loaded function.<span></span></pre></td></tr><tr><td scope="row"><pre>long result = 0;<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>// Get a pointer to the function.<span></span></pre></td></tr><tr><td scope="row"><pre>addOne = (void*)CFBundleGetFunctionPointerForName(<span></span></pre></td></tr><tr><td scope="row"><pre>            myBundle, CFSTR("addOne") );<span></span></pre></td></tr><tr><td scope="row"><pre> <span></span></pre></td></tr><tr><td scope="row"><pre>    // If the function was found, call it with a test value.<span></span></pre></td></tr><tr><td scope="row"><pre>if (addOne)<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    // This should add 1 to whatever was passed in<span></span></pre></td></tr><tr><td scope="row"><pre>    result = addOne ( 23 );<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-123035" title="Loading Objective-C Classes"></a><h3 class="jump">Loading Objective-C Classes</h3><p>If you are writing a Cocoa application, you can load the code for an entire class using the methods of <code><a href="https://developer.apple.com/reference/foundation/bundle" target="_self" class="urlLink">NSBundle</a></code>. The <code>NSBundle</code> methods for loading a class are for use with Objective-C classes only and cannot be used to load classes written in C++ or other object-oriented languages.</p><p>If a loadable bundle defines a principal class, you can load it using the <code><a href="https://developer.apple.com/reference/foundation/bundle/1409048-principalclass" target="_self" class="urlLink">principalClass</a></code> method of <code>NSBundle</code>. The <code>principalClass</code> method uses the <code><!--a  -->NSPrincipalClass<!--/a--></code> key of the bundle’s <code>Info.plist</code> file to identify and load the desired class. Using the principal class alleviates the need to agree on specific naming conventions for external classes, instead letting you focus on the behavior of those interfaces. For example, you might use an instance of the principal class as a factory for creating other relevant objects.</p><p>If you want to load an arbitrary class from a loadable bundle, call the <code><a href="https://developer.apple.com/reference/foundation/bundle/1407299-classnamed" target="_self" class="urlLink">classNamed:</a></code> method of <code>NSBundle</code>. This method searches the bundle for a class matching the name you specify. If the class exists in the bundle, the method returns the corresponding <code>Class</code> object, which you can then use to <span class="pediaLink" data-header="Object creation" data-contents="An object comes into runtime existence through a two-step process that allocates memory for the object and sets its state to reasonable initial values. "><a href="../../../../General/Conceptual/DevPedia-CocoaCore/ObjectCreation.html#//apple_ref/doc/uid/TP40008195-CH39" data-renderer-version="1" target="_self">create instances</a></span> of the class.</p><p><span class="content_text">Listing 3-16</span> shows you a sample method for loading a bundle’s principal class.</p><a name="//apple_ref/doc/uid/10000123i-CH104-124141-BAJHIHJA" title="Listing 3-16Loading the principal class of a bundle"></a><p class="codesample clear"><a name="//apple_ref/doc/uid/20001127-124141" title="Listing 3-16Loading the principal class of a bundle"></a><strong class="caption_number">Listing 3-16</strong>&nbsp;&nbsp;Loading the principal class of a bundle</p><div class="codesample clear"><table><tr><td scope="row"><pre>- (void)loadBundle:(NSString*)bundlePath<span></span></pre></td></tr><tr><td scope="row"><pre>{<span></span></pre></td></tr><tr><td scope="row"><pre>    Class exampleClass;<span></span></pre></td></tr><tr><td scope="row"><pre>    id newInstance;<span></span></pre></td></tr><tr><td scope="row"><pre>    NSBundle *bundleToLoad = [NSBundle bundleWithPath:bundlePath];<span></span></pre></td></tr><tr><td scope="row"><pre>    if (exampleClass = [bundleToLoad principalClass])<span></span></pre></td></tr><tr><td scope="row"><pre>    {<span></span></pre></td></tr><tr><td scope="row"><pre>        newInstance = [[exampleClass alloc] init];<span></span></pre></td></tr><tr><td scope="row"><pre>        // [newInstance doSomething];<span></span></pre></td></tr><tr><td scope="row"><pre>    }<span></span></pre></td></tr><tr><td scope="row"><pre>}<span></span></pre></td></tr></table></div><p>For more information about the methods of the <code>NSBundle</code> class, see <em><a href="https://developer.apple.com/reference/foundation/nsbundle" target="_self" class="urlLink">NSBundle Class Reference</a></em>.</p></section><section><a name="//apple_ref/doc/uid/10000123i-CH104-124675" title="Unloading Bundles"></a><h3 class="jump">Unloading Bundles</h3><p>In macOS v10.5 and later, you can unload the code associated with an <code>NSBundle</code> object using the <code><a href="https://developer.apple.com/reference/foundation/bundle/1412388-unload" target="_self" class="urlLink">unload</a></code> method. You might use this technique to free up memory in an application by removing plug-ins or other loadable bundles that you no longer need. </p><p>If you used Core Foundation to load your bundle, you can use the <code><a href="https://developer.apple.com/reference/corefoundation/1537149-cfbundleunloadexecutable" target="_self" class="urlLink">CFBundleUnloadExecutable</a></code> function to unload it. If your bundle might be unloaded, you need to ensure that string constants are handled correctly by setting an appropriate compiler flag.</p><p>When you compile a bundle with a minimum deployment target of macOS v10.2 (or later), the compiler automatically switches to generating strings that are truly constant in response to <code>CFSTR("...")</code>. The compiler also generates these constant strings if you compile with the flag <code>-fconstant-cfstrings</code>. Constant strings have many benefits and should be used when possible, however if you reference constant strings after the executable containing them is unloaded, the references will be invalid and will cause a crash. This might happen even if the strings have been retained, for example, as a result of being put in data structures, retained directly, and, in some cases, even copied. Rather than trying to make sure all such references are cleaned up at unload time (and some references might be created within the libraries, making them hard to track), it is best to compile unloadable bundles with the flag <code>-fno-constant-cfstrings</code>.</p></section></section>
        <div id="pageNavigationLinks_bottom" class="pageNavigationLinks">
            <a class='nextLink' rel='next' href='../DocumentPackages/DocumentPackages.html'>Next</a><a class='previousLink' rel='prev' href='../BundleTypes/BundleTypes.html'>Previous</a>
        </div><br/>
        <div class="copyright"><br/><hr /><div align="center"><p class="content_text" lang="en" dir="ltr"> Copyright &#x00a9; 2017 Apple Inc. All Rights Reserved. <a href="http://www.apple.com/legal/internet-services/terms/site.html" target="_blank">Terms of Use</a>   |  <a href="http://www.apple.com/privacy/" target="_blank">Privacy Policy</a>  |  Updated: 2017-03-21</p></div></div>

        <div id="pediaWindow">
            <div id="pediaHeader"></div>
            <div id="pediaBody"></div>
        </div>
    </article>

    <div id="blackout">
    <div id="preload"></div>
</div>
<div id="leave_feedback" class="button" role="button" tabindex="0">Feedback</div>
<div id="modal" aria-hidden="true">
    <div id="closebox" tabindex="0" aria-label="Close feedback form" role="button"></div>
    <div id="sending" class="hidden">
        <h2 tabindex="0">Sending feedback&hellip;</h2>
        <div id="sending_img"></div>
    </div>
    <div id="error" class="hidden">
        <h2 tabindex="0">We&rsquo;re sorry, an error has occurred.</h2>
        <p>Please try submitting your feedback later.</p>
        <div id="error_icon"></div>
    </div>
    <div id="success" class="hidden">
        <h2 tabindex="0">Thank you for providing feedback!</h2>
        <p>Your input helps improve our developer documentation.</p>
        <div id="thank_you_icon"></div>
    </div>
    
    <form id="feedback" action="#" method="post">
        <div class="left-leaf">
            <h2 id="helpful_title" data-asterisk="a1" tabindex="0">How helpful is this document?</h2>     
            <sup id="a1" class="asterisk" aria-hidden="true">*</sup>

            <div id="star_group" role="radiogroup" aria-required="true">
                <label> 
                    <input class="radio" type="radio" name="helped" value="1" /> 
                    Very helpful
                </label>
                <label> 
                    <input class="radio" type="radio" name="helped" value="2" /> 
                    Somewhat helpful
                </label>
                <label>
                    <input class="radio" type="radio" name="helped" value="3" /> 
                    Not helpful
                </label>
            </div>
        </div>
        <div class="right-leaf">
            <h2>How can we improve this document?</h2>
            <div id="improve" class="checkboxes">
                <label>
                    <input type="checkbox" name="typo" /> 
                    Fix typos or links
                </label>
                <label>
                    <input type="checkbox" name="infoIncorrect" /> 
                    Fix incorrect information
                </label>
                <label>
                    <input type="checkbox" name="needs_examples" /> 
                    Add or update code samples
                </label>
                <label>
                    <input type="checkbox" name="needs_art" /> 
                    Add or update illustrations
                </label>
                <label>
                    <input type="checkbox" name="missingInfo" /> 
                    Add information about...
                </label>
            </div>
        </div>

        <textarea id="comment" name="problem" cols="70" rows="8" placeholder="Please tell us more about your experience with this document" data-asterisk="a2" required></textarea>
        <sup id="a2" class="asterisk" aria-hidden="true">*</sup>

        <p class="fineprint">
            <em aria-hidden="true"><span>*</span> Required information</em>
        </p> 

        <input id="submit" type="button" value="Send" />

        <section id="legal">
            <p>
                To submit a product bug or enhancement request, please visit the 
                <a href="https://developer.apple.com/bugreporter/" target="_blank">Bug Reporter</a> 
                page.
            </p>
            <p>
                Please read <a href="http://www.apple.com/legal/policies/ideas.html" target="_blank">Apple's Unsolicited Idea Submission Policy</a> 
                before you send us your feedback.
            </p> 
        </section>
    </form>
</div>

    
    <script charset="utf-8" src="../../../../../Resources/1260/JavaScript/lib/prototype.js"></script>
    <script src="../../../../../Resources/1260/JavaScript/library.js"></script>
    <script src="../../../../../Resources/1260/JavaScript/feedback.js"></script>
</body>
</html>
